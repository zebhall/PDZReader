# imports
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import numpy as np
import scipy.signal as sig


# duplex only data

# starting energy of the first channel/bin, in eV
ev_channel_start_p1 = 0.131126523017883
# width of each channel/bin, in eV
ev_per_channel_p1 = 19.98322487
# total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
num_of_channels = 2048 #
# counts for each bin, as arrays (usually y-axis value on spectra)
counts_p1 = np.array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 66, 554, 2321, 4689, 4597, 2239, 556, 86, 7, 0, 0, 0, 1, 64, 90, 58, 72, 75, 47, 68, 79, 74, 78, 79, 76, 93, 168, 210, 233, 238, 191, 208, 184, 153, 122, 141, 175, 159, 135, 150, 124, 122, 120, 170, 162, 182, 174, 182, 172, 154, 149, 151, 178, 343, 755, 2087, 4497, 7403, 8958, 8094, 5730, 3560, 2342, 1706, 1290, 1531, 4075, 13197, 34351, 68103, 101127, 110318, 88864, 55411, 27852, 13187, 7031, 4028, 2169, 1097, 562, 337, 275, 210, 210, 188, 148, 167, 140, 145, 145, 134, 155, 180, 208, 287, 510, 765, 1174, 1384, 1394, 1248, 996, 758, 632, 561, 510, 557, 562, 594, 962, 1587, 3242, 5494, 8200, 10153, 11065, 10684, 10037, 8784, 7170, 5135, 3961, 3562, 3963, 4691, 4752, 4430, 3844, 3703, 4083, 4607, 4851, 4240, 3284, 2283, 1541, 1042, 757, 755, 787, 897, 1185, 1775, 3502, 7987, 17028, 31760, 49555, 63999, 68154, 58981, 42542, 24963, 12344, 5549, 2669, 1845, 1838, 2434, 3717, 5655, 7977, 9748, 10412, 10006, 9571, 9221, 8596, 8154, 6712, 4879, 3055, 1748, 954, 657, 468, 415, 448, 464, 586, 700, 964, 1169, 1372, 1461, 1328, 1094, 949, 661, 492, 513, 474, 453, 471, 431, 391, 463, 460, 501, 497, 580, 707, 953, 1283, 1819, 2355, 2814, 3212, 3066, 2786, 2230, 1734, 1267, 997, 894, 816, 796, 804, 787, 824, 885, 1119, 1272, 1469, 1703, 1800, 1758, 1613, 1586, 1387, 1380, 1268, 1323, 1411, 1495, 1638, 1663, 1726, 1736, 1657, 1611, 1623, 1404, 1345, 1308, 1199, 1199, 1180, 1224, 1313, 1393, 1544, 1613, 1698, 1801, 1728, 1614, 1524, 1486, 1406, 1286, 1307, 1295, 1208, 1192, 1172, 1172, 1163, 1165, 1133, 1135, 1178, 1234, 1205, 1293, 1297, 1393, 1418, 1487, 1483, 1485, 1540, 1503, 1445, 1396, 1411, 1278, 1281, 1339, 1323, 1326, 1280, 1331, 1403, 1464, 1724, 2066, 2704, 4036, 5957, 8444, 11096, 13428, 14635, 14111, 12554, 9857, 7116, 5082, 3305, 2322, 1835, 1579, 1431, 1413, 1524, 1375, 1351, 1342, 1318, 1303, 1256, 1236, 1309, 1250, 1309, 1355, 1296, 1356, 1519, 1600, 1788, 2135, 2461, 2792, 3044, 3083, 3040, 2694, 2377, 1924, 1615, 1346, 1265, 1184, 1102, 1149, 1086, 1116, 1184, 1201, 1203, 1172, 1241, 1318, 1345, 1383, 1427, 1341, 1380, 1296, 1194, 1174, 1143, 1145, 1131, 1120, 1114, 1064, 1027, 1073, 1095, 1103, 1056, 1072, 1009, 1156, 1050, 1060, 1105, 1088, 1104, 1112, 1073, 1077, 1133, 1152, 1108, 1168, 1183, 1168, 1241, 1135, 1170, 1212, 1084, 1110, 1088, 1069, 1091, 1115, 1139, 1049, 1055, 1079, 1078, 1142, 1083, 1114, 1100, 1093, 1139, 1141, 1153, 1134, 1216, 1107, 1156, 1145, 1127, 1183, 1142, 1181, 1115, 1165, 1124, 1147, 1162, 1155, 1131, 1193, 1139, 1125, 1099, 1152, 1106, 1158, 1169, 1115, 1165, 1204, 1165, 1179, 1146, 1184, 1125, 1200, 1201, 1273, 1230, 1126, 1124, 1122, 1120, 1180, 1143, 1060, 1129, 1070, 1093, 1121, 1089, 1077, 1064, 1087, 1068, 1109, 1100, 1152, 1151, 1058, 1093, 1102, 1136, 1083, 1063, 1023, 1126, 1043, 1038, 1057, 1034, 1036, 1110, 1060, 1025, 1081, 1140, 1045, 1073, 1118, 1067, 1047, 1071, 1118, 1076, 1099, 1083, 1008, 1089, 1155, 1084, 1097, 1110, 1015, 1041, 1031, 1045, 968, 1022, 1070, 1028, 1007, 1084, 1018, 1003, 1005, 1038, 980, 1069, 1024, 944, 976, 961, 1059, 1061, 979, 1031, 1045, 971, 988, 1034, 969, 963, 957, 999, 986, 1008, 985, 944, 979, 1006, 970, 974, 1019, 954, 895, 913, 948, 987, 923, 933, 910, 865, 871, 882, 861, 882, 841, 864, 847, 852, 885, 830, 811, 814, 905, 795, 835, 825, 846, 808, 764, 796, 808, 782, 788, 790, 756, 751, 796, 776, 763, 788, 750, 754, 770, 714, 675, 703, 691, 675, 694, 716, 658, 705, 677, 707, 684, 655, 689, 613, 639, 657, 620, 655, 656, 655, 586, 584, 551, 607, 621, 567, 604, 584, 584, 580, 527, 566, 570, 566, 589, 508, 541, 567, 553, 549, 529, 515, 477, 496, 489, 468, 492, 450, 502, 472, 482, 474, 451, 495, 432, 470, 447, 409, 418, 409, 441, 397, 395, 363, 376, 385, 377, 325, 372, 357, 382, 359, 346, 353, 363, 286, 317, 319, 314, 275, 302, 312, 288, 266, 274, 264, 269, 283, 267, 246, 243, 240, 228, 216, 220, 192, 202, 207, 176, 172, 161, 188, 185, 177, 166, 144, 125, 142, 130, 146, 120, 117, 117, 128, 108, 88, 92, 92, 77, 93, 77, 96, 71, 72, 85, 60, 47, 60, 61, 51, 47, 43, 28, 44, 40, 38, 36, 30, 33, 28, 26, 27, 20, 21, 24, 25, 20, 14, 13, 17, 14, 13, 21, 19, 17, 24, 18, 17, 24, 11, 17, 14, 9, 15, 9, 18, 13, 14, 10, 19, 16, 16, 19, 9, 15, 14, 8, 15, 9, 12, 15, 15, 15, 11, 12, 14, 16, 12, 10, 12, 9, 8, 8, 8, 14, 10, 17, 19, 16, 13, 11, 13, 11, 6, 10, 9, 12, 13, 11, 12, 12, 15, 9, 7, 15, 10, 7, 6, 9, 5, 14, 11, 11, 4, 4, 9, 16, 16, 2, 10, 9, 12, 14, 15, 6, 9, 7, 9, 8, 6, 5, 6, 9, 7, 9, 7, 9, 3, 4, 6, 6, 7, 7, 1, 10, 9, 12, 6, 8, 7, 5, 10, 12, 7, 8, 11, 6, 4, 10, 3, 8, 4, 4, 5, 7, 3, 8, 6, 5, 4, 6, 5, 3, 5, 2, 9, 5, 3, 4, 5, 5, 5, 3, 7, 5, 4, 8, 10, 8, 4, 7, 1, 12, 9, 4, 5, 6, 7, 5, 5, 1, 4, 6, 2, 5, 3, 3, 5, 2, 2, 2, 5, 3, 3, 3, 4, 5, 6, 7, 5, 4, 4, 4, 3, 3, 2, 4, 4, 4, 3, 4, 2, 2, 4, 5, 5, 4, 4, 5, 2, 2, 3, 3, 4, 0, 3, 0, 0, 0, 2, 5, 3, 2, 3, 5, 3, 1, 2, 5, 2, 3, 8, 2, 4, 0, 4, 1, 3, 2, 3, 1, 3, 3, 5, 2, 3, 5, 3, 2, 4, 4, 3, 2, 2, 5, 3, 0, 1, 3, 3, 1, 3, 3, 2, 3, 3, 1, 2, 1, 1, 3, 1, 4, 2, 3, 5, 2, 1, 2, 3, 4, 4, 2, 2, 0, 1, 1, 0, 2, 3, 3, 0, 0, 1, 4, 0, 2, 3, 5, 2, 2, 1, 1, 0, 1, 0, 3, 3, 2, 3, 4, 2, 2, 1, 0, 2, 5, 2, 1, 2, 1, 1, 2, 0, 3, 0, 1, 2, 1, 1, 3, 1, 1, 0, 2, 0, 1, 1, 1, 0, 0, 1, 3, 0, 0, 1, 4, 0, 0, 0, 0, 2, 2, 3, 1, 0, 0, 1, 2, 2, 1, 0, 1, 1, 2, 2, 1, 0, 1, 2, 1, 0, 1, 0, 2, 0, 2, 2, 3, 3, 0, 1, 1, 1, 0, 1, 2, 2, 2, 0, 1, 3, 1, 2, 1, 2, 3, 1, 1, 0, 2, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 3, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 2, 0, 0, 2, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2, 1, 0, 1, 0, 1, 1, 0, 0, 2, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])

# highest hg data

# starting energy of the first channel/bin, in eV
ev_channel_start_p2 = -0.0174355879426002
# width of each channel/bin, in eV
ev_per_channel_p2 = 19.98322487
# total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
num_of_channels = 2048 #
# counts for each bin, as arrays (usually y-axis value on spectra)
counts_p2 = np.array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 60, 618, 2468, 4968, 4853, 2366, 560, 88, 8, 2, 2, 1, 3, 530, 565, 530, 545, 566, 568, 506, 522, 561, 487, 551, 486, 540, 514, 531, 506, 505, 491, 528, 435, 499, 504, 473, 492, 489, 464, 469, 534, 510, 481, 459, 457, 443, 473, 469, 458, 439, 462, 451, 435, 463, 438, 474, 434, 430, 454, 454, 471, 416, 459, 450, 382, 471, 396, 417, 471, 488, 508, 571, 532, 490, 427, 466, 438, 458, 422, 405, 380, 418, 439, 390, 438, 398, 397, 455, 353, 399, 414, 407, 373, 405, 401, 410, 372, 404, 377, 393, 398, 378, 348, 405, 431, 381, 369, 356, 344, 364, 378, 386, 369, 387, 378, 442, 399, 374, 339, 379, 352, 370, 341, 338, 329, 330, 310, 359, 346, 345, 343, 333, 338, 287, 321, 320, 332, 320, 316, 305, 364, 334, 349, 385, 336, 443, 517, 721, 846, 1013, 986, 867, 704, 547, 444, 380, 357, 402, 401, 425, 401, 469, 413, 377, 417, 371, 334, 383, 343, 332, 350, 307, 315, 275, 252, 251, 259, 219, 231, 264, 222, 224, 237, 227, 223, 211, 228, 221, 225, 201, 200, 211, 190, 200, 175, 179, 206, 222, 197, 184, 180, 187, 186, 194, 179, 178, 209, 222, 249, 234, 233, 190, 198, 194, 166, 160, 149, 161, 168, 145, 151, 163, 153, 155, 191, 188, 167, 173, 171, 152, 152, 151, 152, 154, 105, 141, 144, 143, 132, 110, 118, 114, 125, 125, 121, 108, 102, 124, 102, 95, 114, 122, 114, 139, 132, 151, 145, 147, 138, 109, 100, 107, 100, 99, 94, 89, 96, 98, 75, 74, 79, 93, 93, 80, 85, 82, 103, 77, 72, 80, 93, 89, 85, 68, 96, 75, 67, 64, 61, 65, 59, 56, 54, 48, 63, 77, 85, 105, 157, 231, 453, 611, 867, 1130, 1183, 1134, 990, 789, 565, 339, 214, 124, 73, 57, 51, 49, 57, 44, 56, 40, 45, 42, 47, 35, 44, 46, 31, 50, 48, 36, 54, 67, 94, 129, 165, 188, 201, 238, 226, 193, 127, 124, 92, 59, 54, 46, 39, 26, 30, 43, 25, 33, 33, 53, 50, 53, 34, 55, 50, 47, 49, 45, 41, 39, 29, 36, 27, 30, 33, 20, 23, 30, 31, 23, 30, 25, 29, 22, 26, 29, 37, 41, 36, 31, 38, 51, 51, 37, 32, 42, 33, 35, 31, 41, 35, 24, 27, 29, 34, 35, 32, 22, 30, 24, 31, 17, 42, 31, 27, 31, 32, 23, 31, 38, 30, 31, 32, 45, 38, 25, 28, 31, 36, 30, 25, 37, 30, 24, 35, 27, 37, 40, 26, 31, 24, 39, 23, 19, 20, 34, 30, 33, 21, 39, 36, 25, 38, 47, 38, 26, 32, 29, 22, 23, 31, 26, 24, 24, 23, 21, 22, 30, 29, 28, 27, 32, 30, 50, 36, 36, 31, 42, 35, 36, 37, 29, 25, 37, 31, 29, 29, 29, 20, 30, 16, 29, 25, 23, 13, 21, 25, 13, 21, 28, 20, 31, 17, 22, 26, 28, 28, 26, 29, 26, 34, 25, 45, 35, 51, 40, 41, 67, 72, 58, 58, 51, 42, 34, 30, 28, 26, 20, 27, 25, 30, 28, 30, 31, 26, 20, 24, 27, 23, 21, 18, 24, 26, 29, 28, 22, 23, 19, 22, 22, 26, 29, 18, 28, 20, 26, 22, 32, 10, 21, 26, 38, 24, 26, 38, 35, 36, 28, 24, 31, 24, 28, 29, 19, 34, 26, 12, 24, 23, 20, 21, 25, 31, 34, 25, 20, 23, 27, 26, 24, 30, 28, 22, 20, 21, 33, 22, 23, 26, 25, 20, 22, 20, 25, 36, 26, 30, 30, 33, 30, 20, 28, 27, 33, 27, 39, 48, 40, 51, 61, 65, 54, 66, 66, 70, 57, 53, 45, 36, 36, 34, 33, 37, 37, 26, 29, 39, 33, 46, 45, 33, 29, 39, 40, 32, 49, 31, 49, 50, 57, 76, 115, 166, 210, 282, 388, 409, 542, 547, 602, 581, 568, 468, 400, 346, 308, 227, 135, 112, 74, 64, 57, 40, 44, 41, 41, 46, 34, 45, 39, 49, 47, 47, 44, 68, 78, 119, 164, 271, 369, 573, 755, 1066, 1358, 1734, 2016, 2232, 2467, 2498, 2444, 2246, 1913, 1592, 1267, 921, 634, 449, 309, 190, 152, 100, 59, 50, 33, 33, 40, 30, 38, 37, 39, 33, 39, 46, 34, 27, 41, 36, 42, 49, 63, 59, 84, 81, 116, 107, 122, 139, 148, 159, 183, 154, 123, 138, 112, 85, 75, 74, 58, 73, 58, 61, 65, 56, 59, 66, 44, 45, 48, 52, 52, 44, 48, 56, 45, 43, 56, 55, 64, 71, 74, 90, 97, 123, 160, 210, 270, 346, 354, 425, 508, 527, 546, 598, 553, 570, 462, 359, 323, 269, 205, 180, 161, 145, 151, 133, 116, 112, 125, 90, 99, 94, 81, 63, 69, 59, 62, 74, 61, 59, 52, 66, 76, 49, 51, 64, 52, 67, 89, 72, 86, 83, 66, 85, 85, 83, 72, 76, 68, 71, 60, 74, 68, 69, 87, 81, 81, 69, 85, 87, 75, 80, 85, 86, 76, 86, 81, 88, 88, 114, 96, 109, 128, 155, 181, 237, 261, 357, 394, 456, 530, 635, 671, 697, 640, 728, 668, 614, 611, 538, 424, 332, 306, 279, 214, 217, 162, 159, 153, 138, 137, 125, 128, 142, 146, 139, 122, 140, 130, 148, 129, 123, 135, 140, 152, 139, 156, 140, 161, 153, 177, 152, 164, 159, 156, 171, 201, 175, 191, 184, 209, 169, 196, 191, 227, 218, 222, 212, 240, 237, 228, 286, 285, 285, 309, 315, 339, 346, 325, 359, 414, 384, 429, 441, 440, 480, 497, 467, 514, 543, 574, 563, 598, 641, 629, 594, 625, 651, 608, 643, 638, 671, 663, 651, 632, 624, 688, 629, 605, 589, 582, 572, 545, 493, 491, 489, 488, 485, 476, 472, 491, 498, 479, 453, 456, 448, 406, 322, 347, 356, 304, 311, 301, 311, 310, 305, 309, 339, 341, 339, 376, 418, 450, 477, 557, 521, 564, 616, 659, 723, 681, 709, 740, 685, 647, 568, 546, 493, 458, 409, 358, 312, 287, 287, 284, 239, 238, 271, 246, 293, 246, 278, 235, 252, 283, 289, 284, 265, 286, 268, 295, 295, 273, 283, 308, 321, 324, 317, 326, 296, 338, 365, 341, 382, 358, 361, 367, 391, 397, 413, 402, 397, 430, 411, 425, 446, 417, 438, 490, 485, 494, 454, 451, 438, 468, 514, 461, 489, 469, 505, 434, 486, 480, 470, 457, 428, 470, 427, 460, 419, 392, 461, 427, 400, 422, 407, 409, 401, 360, 429, 367, 371, 375, 363, 390, 378, 365, 387, 366, 406, 344, 371, 340, 399, 363, 353, 341, 323, 363, 369, 353, 317, 358, 386, 363, 351, 360, 353, 380, 376, 395, 421, 441, 467, 492, 493, 488, 559, 540, 523, 498, 446, 439, 461, 408, 419, 421, 389, 387, 408, 383, 377, 356, 355, 368, 385, 397, 395, 402, 392, 383, 358, 383, 390, 378, 386, 402, 361, 351, 368, 376, 394, 381, 372, 366, 360, 367, 377, 397, 412, 380, 386, 382, 383, 365, 389, 431, 394, 381, 455, 435, 475, 538, 607, 630, 716, 803, 980, 1035, 1176, 1173, 1289, 1457, 1542, 1552, 1607, 1754, 1805, 1898, 1918, 1982, 2083, 2014, 1935, 1888, 1830, 1658, 1462, 1287, 1123, 954, 808, 773, 612, 598, 531, 509, 455, 428, 461, 421, 406, 424, 437, 423, 449, 423, 441, 454, 442, 454, 429, 442, 483, 506, 487, 516, 462, 482, 498, 515, 532, 542, 532, 532, 557, 621, 569, 586, 577, 594, 580, 630, 601, 679, 635, 606, 649, 651, 602, 573, 585, 545, 504, 509, 497, 520, 482, 464, 514, 477, 525, 454, 518, 469, 456, 451, 458, 457, 468, 467, 483, 489, 484, 496, 482, 505, 470, 479, 484, 481, 495, 467, 521, 498, 465, 497, 515, 527, 485, 526, 504, 481, 505, 507, 538, 518, 548, 528, 530, 511, 557, 552, 522, 484, 562, 525, 527, 483, 534, 522, 550, 525, 472, 519, 521, 496, 505, 523, 525, 538, 539, 522, 536, 513, 526, 547, 508, 539, 535, 521, 530, 606, 567, 598, 612, 631, 666, 710, 748, 766, 781, 806, 839, 885, 852, 929, 848, 865, 857, 745, 836, 771, 698, 726, 663, 677, 649, 589, 603, 626, 571, 620, 588, 587, 567, 567, 596, 546, 599, 619, 599, 586, 617, 585, 598, 589, 547, 575, 559, 533, 522, 505, 481, 502, 463, 449, 500, 509, 478, 439, 517, 510, 450, 473, 460, 526, 548, 473, 481, 537, 489, 518, 538, 498, 547, 544, 565, 501, 511, 497, 547, 501, 497, 514, 530, 502, 474, 571, 500, 522, 517, 533, 473, 544, 502, 502, 511, 531, 490, 485, 505, 498, 516, 532, 512, 510, 491, 543, 535, 527, 548, 544, 498, 507, 493, 499, 519, 515, 494, 531, 492, 560, 511, 491, 533, 526, 518, 501, 506, 516, 484, 523, 513, 526, 505, 533, 523, 515, 501, 518, 534, 496, 545, 521, 553, 508, 538, 495, 476, 481, 516, 479, 526, 540, 521, 502, 491, 490, 519, 524, 497, 499, 492, 524, 539, 495, 504, 502, 486, 520, 503, 530, 516, 522, 489, 521, 500, 527, 553, 515, 519, 539, 491, 522, 507, 518, 468, 517, 512, 469, 474, 526, 524, 514, 530, 503, 511, 499, 480, 517, 536, 524, 503, 548, 510, 535, 545, 551, 481, 508, 542, 500, 513, 508, 484, 525, 516, 522, 527, 508, 512, 530, 509, 523, 557, 511, 594, 553, 592, 585, 629, 686, 736, 736, 825, 914, 1046, 1141, 1266, 1257, 1346, 1339, 1389, 1376, 1377, 1343, 1306, 1160, 1195, 1143, 1162, 1213, 1240, 1306, 1415, 1539, 1650, 1785, 1852, 1955, 1891, 1963, 1994, 1934, 1878, 1682, 1469, 1413, 1330, 1128, 990, 877, 784, 725, 657, 620, 591, 542, 574, 515, 473, 484, 494, 478, 486, 464, 475, 501, 471, 469, 457, 506, 497, 460, 475, 477, 485, 428, 466, 527, 438, 462, 486, 508, 450, 472, 497, 484, 477, 464, 426, 457, 496, 442, 476, 467, 464, 507, 464, 453, 439, 488, 442, 495, 454, 462, 469, 483, 495, 468, 450, 428, 485, 475, 460, 428, 429, 510, 458, 435, 449, 446, 433, 454, 431, 451, 454, 450, 450, 428, 458, 421, 441, 441, 456, 446, 469, 450, 425, 460, 430, 440, 446, 425, 437, 422, 446, 426, 466, 465, 459, 486, 415, 471, 454, 448, 447, 448, 469, 455, 458, 455, 462, 461, 427, 396, 411, 455, 412, 404, 481, 444, 440, 445, 403, 424, 429, 392, 439, 397, 438, 439, 433, 421, 429, 417, 421, 410, 382, 437, 435, 384, 419, 431, 457, 423, 421, 426, 443, 404, 443, 391, 430, 406, 436, 396, 439, 378, 413, 405, 452, 445, 438, 403, 417, 397, 394, 410, 423, 407, 429, 406, 421, 396, 411, 391, 429, 406, 398, 424, 427, 366, 419, 402, 455, 477, 445, 455, 522, 479, 528, 547, 599, 605, 657, 687, 627, 739, 721, 722, 694, 710, 646, 669, 611, 612, 573, 527, 506, 481, 482, 446, 473, 406, 413, 403, 401, 399, 349, 372, 373, 381, 375, 379, 383, 355, 385, 369, 357, 377, 397, 385, 409, 331, 392, 369, 400, 423, 383, 385, 390, 388, 432, 439, 427, 432, 438, 404, 447, 457, 392, 416, 382, 395, 353, 413, 365, 357, 374, 387, 342, 364, 361, 340, 339, 327, 306, 346, 323, 326, 334, 359, 309, 328, 314, 308, 330, 324, 339, 337, 318, 275, 329, 312, 321, 327, 302, 273, 314, 272, 291, 300, 297, 316, 310, 322, 301, 286, 291, 289, 310, 327, 281, 294, 307, 276, 314, 306, 274, 294, 265, 312, 292, 270, 318, 314, 285, 285, 306, 282, 289, 308, 283, 290, 296, 280, 270, 289, 282, 285, 263, 262, 290, 276, 283, 287, 266, 275, 264, 288, 285, 259, 261, 247, 280, 251, 262, 270, 266, 270, 279, 281, 266, 293, 272, 278, 218, 239, 246, 265, 265, 266, 232, 230, 261, 241, 239, 281, 236, 263, 215, 274, 244, 254, 251, 232, 254, 251, 229, 242, 256, 257, 255, 253, 218, 247, 232, 230, 246, 246, 227, 241, 202, 230, 234, 228, 203, 212, 222, 211, 214, 211, 233, 229, 202, 237, 213, 214, 211, 207, 226, 249, 200, 191, 210, 221, 194, 209, 223, 185, 189, 184, 173, 207, 196, 192, 177, 191])

# PHASE 3 data

# starting energy of the first channel/bin, in eV
ev_channel_start_p3 = -0.171099484
# width of each channel/bin, in eV
ev_per_channel_p3 = 19.98322487
# total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
num_of_channels = 2048 #
# counts for each bin as, arrays (usually y-axis value on spectra)
counts_p3 = np.array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 68, 561, 2313, 4844, 4657, 2226, 546, 69, 7, 1, 0, 2, 2, 253, 285, 295, 278, 297, 301, 295, 272, 267, 274, 282, 287, 288, 274, 271, 238, 273, 249, 265, 264, 283, 228, 225, 261, 256, 252, 260, 264, 257, 244, 252, 242, 245, 256, 225, 246, 233, 223, 238, 220, 210, 209, 248, 284, 310, 290, 290, 270, 269, 256, 242, 198, 199, 218, 261, 418, 762, 1011, 1022, 939, 583, 383, 295, 227, 224, 171, 183, 136, 143, 147, 133, 140, 139, 123, 129, 115, 139, 111, 117, 127, 116, 132, 99, 110, 117, 96, 105, 115, 95, 84, 100, 90, 57, 67, 84, 80, 71, 80, 93, 110, 179, 206, 244, 243, 161, 119, 88, 71, 66, 52, 53, 61, 61, 76, 67, 62, 96, 93, 106, 128, 137, 129, 76, 51, 50, 36, 52, 45, 41, 62, 76, 182, 379, 874, 1662, 2536, 3230, 3521, 2902, 2196, 1254, 717, 318, 164, 115, 136, 194, 193, 375, 421, 513, 576, 548, 546, 546, 549, 483, 403, 298, 187, 98, 57, 37, 30, 24, 42, 26, 51, 47, 54, 68, 87, 83, 66, 59, 55, 38, 26, 23, 24, 19, 15, 16, 17, 20, 20, 27, 22, 17, 31, 55, 84, 153, 226, 288, 294, 286, 250, 196, 130, 93, 60, 68, 68, 41, 36, 47, 43, 56, 82, 103, 146, 165, 187, 190, 165, 152, 147, 119, 93, 67, 54, 49, 34, 27, 39, 32, 43, 60, 56, 54, 66, 39, 36, 37, 34, 35, 49, 36, 56, 62, 73, 69, 95, 63, 67, 52, 43, 49, 43, 38, 40, 32, 28, 23, 25, 32, 24, 29, 57, 46, 43, 65, 62, 66, 68, 72, 78, 64, 59, 42, 51, 45, 26, 23, 25, 25, 27, 38, 25, 23, 47, 61, 104, 246, 525, 953, 1739, 2691, 3760, 4775, 5012, 4979, 4292, 3243, 2321, 1401, 753, 433, 198, 104, 68, 43, 38, 38, 37, 30, 32, 28, 29, 24, 27, 32, 27, 36, 54, 71, 103, 174, 235, 357, 513, 668, 764, 858, 831, 714, 519, 393, 259, 138, 100, 50, 30, 19, 21, 21, 16, 21, 20, 27, 33, 37, 64, 61, 48, 58, 40, 37, 32, 37, 23, 31, 22, 22, 23, 13, 10, 22, 18, 30, 14, 17, 26, 24, 23, 24, 30, 22, 19, 36, 39, 35, 32, 46, 37, 30, 32, 44, 41, 26, 31, 38, 20, 32, 26, 31, 32, 19, 36, 40, 26, 25, 32, 27, 34, 31, 27, 41, 57, 61, 55, 76, 70, 78, 67, 62, 50, 41, 37, 39, 48, 31, 31, 39, 54, 46, 51, 52, 47, 47, 48, 43, 54, 53, 54, 58, 64, 76, 91, 86, 117, 109, 143, 118, 128, 130, 103, 95, 81, 72, 68, 60, 68, 70, 71, 58, 86, 74, 77, 79, 90, 97, 80, 104, 74, 78, 92, 110, 105, 79, 96, 104, 93, 112, 104, 93, 128, 126, 120, 113, 116, 98, 97, 110, 124, 124, 112, 127, 128, 117, 147, 164, 147, 139, 150, 177, 160, 146, 162, 184, 205, 200, 232, 246, 254, 312, 357, 350, 367, 348, 364, 293, 271, 255, 254, 236, 241, 230, 210, 211, 225, 230, 236, 244, 247, 239, 255, 245, 245, 226, 253, 274, 237, 273, 275, 261, 247, 259, 285, 309, 282, 291, 261, 289, 308, 324, 292, 272, 283, 321, 302, 317, 314, 358, 348, 346, 385, 317, 320, 365, 365, 374, 365, 397, 386, 349, 372, 408, 413, 403, 382, 406, 357, 431, 443, 413, 426, 437, 422, 468, 395, 474, 471, 424, 455, 463, 420, 463, 468, 455, 477, 456, 507, 484, 474, 513, 499, 493, 514, 514, 507, 548, 512, 502, 572, 611, 574, 668, 682, 688, 712, 720, 704, 746, 657, 639, 612, 633, 643, 635, 606, 617, 623, 608, 607, 618, 612, 584, 653, 642, 652, 658, 676, 646, 649, 658, 712, 679, 723, 768, 863, 984, 1077, 1336, 1613, 1819, 2004, 2315, 2501, 2673, 2658, 2516, 2332, 2060, 1762, 1515, 1342, 1170, 1054, 987, 874, 873, 851, 810, 822, 783, 834, 808, 841, 828, 835, 858, 864, 900, 972, 949, 1103, 1280, 1515, 1975, 2553, 3103, 4040, 4926, 6068, 6930, 7774, 8115, 8331, 8243, 7602, 6728, 5697, 4669, 3853, 2987, 2268, 1757, 1437, 1186, 1106, 1041, 1009, 972, 987, 931, 933, 977, 952, 988, 927, 981, 976, 966, 1050, 1025, 1033, 1105, 1069, 1051, 1091, 1194, 1175, 1148, 1310, 1277, 1388, 1446, 1430, 1391, 1397, 1400, 1403, 1289, 1281, 1199, 1230, 1102, 1206, 1121, 1178, 1167, 1122, 1183, 1101, 1073, 1098, 1070, 1082, 1091, 1082, 1090, 1075, 1126, 1081, 1155, 1132, 1148, 1178, 1154, 1278, 1297, 1324, 1433, 1533, 1689, 1823, 1990, 2127, 2328, 2425, 2483, 2545, 2586, 2368, 2253, 2136, 1964, 1801, 1622, 1535, 1489, 1422, 1387, 1354, 1362, 1342, 1385, 1338, 1297, 1286, 1262, 1251, 1228, 1219, 1253, 1152, 1206, 1179, 1225, 1204, 1235, 1206, 1188, 1249, 1170, 1198, 1315, 1191, 1269, 1229, 1217, 1300, 1241, 1174, 1220, 1263, 1277, 1187, 1248, 1231, 1295, 1186, 1318, 1312, 1242, 1266, 1264, 1293, 1280, 1276, 1266, 1229, 1280, 1243, 1299, 1259, 1284, 1282, 1305, 1280, 1310, 1349, 1351, 1288, 1288, 1342, 1321, 1397, 1420, 1363, 1402, 1424, 1460, 1441, 1501, 1486, 1422, 1426, 1484, 1422, 1441, 1421, 1421, 1407, 1432, 1411, 1409, 1390, 1365, 1397, 1350, 1356, 1443, 1415, 1419, 1408, 1432, 1418, 1463, 1410, 1432, 1446, 1451, 1464, 1442, 1410, 1430, 1492, 1497, 1536, 1477, 1510, 1557, 1537, 1547, 1623, 1524, 1632, 1506, 1576, 1661, 1613, 1656, 1687, 1646, 1662, 1741, 1794, 1753, 1848, 1872, 1930, 1850, 2009, 1991, 2042, 2121, 2140, 2280, 2255, 2399, 2432, 2448, 2488, 2541, 2655, 2761, 2793, 2799, 2903, 2946, 2928, 3062, 3055, 3097, 3096, 3075, 3021, 3098, 3065, 3011, 3085, 2923, 2907, 2912, 2880, 2772, 2781, 2573, 2610, 2696, 2482, 2383, 2477, 2363, 2299, 2255, 2094, 2037, 2052, 1993, 1943, 1950, 1806, 1820, 1796, 1832, 1764, 1740, 1670, 1634, 1684, 1666, 1759, 1729, 1719, 1800, 1804, 1772, 2019, 2132, 2308, 2385, 2486, 2645, 2671, 2813, 2918, 2991, 2993, 2966, 2897, 2746, 2607, 2398, 2326, 2055, 1934, 1795, 1676, 1553, 1460, 1412, 1430, 1401, 1368, 1436, 1387, 1441, 1387, 1328, 1399, 1347, 1339, 1346, 1433, 1357, 1397, 1397, 1332, 1352, 1404, 1429, 1381, 1445, 1440, 1424, 1430, 1448, 1489, 1469, 1453, 1432, 1440, 1576, 1477, 1492, 1499, 1524, 1555, 1592, 1562, 1521, 1607, 1541, 1598, 1585, 1593, 1620, 1630, 1619, 1650, 1612, 1630, 1630, 1600, 1611, 1501, 1559, 1618, 1553, 1539, 1542, 1435, 1555, 1561, 1484, 1518, 1473, 1476, 1448, 1434, 1401, 1438, 1426, 1396, 1391, 1401, 1278, 1339, 1388, 1349, 1326, 1258, 1256, 1202, 1358, 1262, 1335, 1288, 1169, 1190, 1239, 1201, 1216, 1206, 1209, 1243, 1260, 1175, 1145, 1182, 1182, 1159, 1116, 1189, 1254, 1207, 1238, 1321, 1376, 1393, 1368, 1471, 1483, 1498, 1529, 1412, 1404, 1362, 1300, 1255, 1246, 1226, 1188, 1176, 1086, 1124, 1104, 1103, 1040, 1082, 1070, 1032, 1088, 1112, 1067, 1040, 1079, 1137, 1095, 1034, 1040, 1049, 1052, 1023, 1046, 988, 1033, 1005, 994, 960, 980, 989, 988, 1000, 1010, 903, 944, 953, 941, 956, 987, 987, 946, 1005, 923, 921, 957, 931, 928, 945, 916, 977, 952, 927, 941, 926, 907, 907, 966, 954, 951, 950, 937, 879, 941, 890, 940, 915, 849, 944, 896, 913, 906, 816, 903, 902, 834, 878, 853, 805, 866, 790, 878, 855, 783, 892, 769, 867, 844, 761, 783, 831, 775, 810, 844, 804, 826, 767, 794, 769, 775, 744, 786, 756, 800, 723, 743, 725, 741, 728, 717, 758, 661, 687, 700, 729, 724, 707, 727, 737, 662, 669, 702, 688, 682, 635, 726, 666, 614, 646, 619, 646, 623, 626, 609, 645, 579, 624, 675, 569, 587, 545, 587, 581, 565, 579, 540, 573, 534, 546, 503, 556, 530, 508, 499, 507, 526, 490, 495, 513, 489, 480, 489, 466, 416, 490, 446, 449, 465, 448, 451, 441, 421, 391, 462, 417, 381, 404, 374, 400, 382, 386, 359, 373, 413, 388, 376, 351, 356, 338, 375, 296, 334, 340, 294, 278, 269, 313, 287, 293, 295, 267, 299, 246, 251, 296, 275, 250, 242, 245, 205, 248, 186, 194, 217, 220, 200, 210, 212, 195, 196, 192, 180, 183, 168, 191, 154, 157, 145, 150, 152, 158, 154, 136, 145, 139, 125, 143, 111, 114, 117, 131, 111, 110, 119, 107, 116, 111, 97, 93, 122, 105, 103, 96, 88, 77, 85, 75, 85, 67, 75, 56, 65, 77, 79, 56, 67, 73, 66, 59, 56, 65, 60, 51, 48, 61, 61, 46, 61, 37, 49, 56, 51, 43, 39, 43, 39, 31, 34, 39, 25, 27, 41, 31, 22, 30, 39, 38, 32, 28, 37, 26, 23, 28, 24, 27, 26, 27, 29, 32, 23, 21, 17, 23, 24, 19, 13, 12, 17, 19, 17, 20, 11, 18, 20, 20, 16, 16, 15, 11, 10, 12, 9, 10, 12, 9, 13, 12, 7, 9, 8, 7, 8, 7, 11, 6, 10, 6, 1, 8, 4, 6, 7, 8, 5, 10, 8, 4, 6, 6, 3, 4, 5, 1, 3, 4, 6, 3, 3, 4, 8, 2, 7, 4, 2, 5, 4, 5, 10, 6, 6, 3, 5, 7, 4, 5, 6, 2, 4, 7, 13, 4, 6, 3, 2, 3, 5, 8, 4, 8, 6, 5, 5, 6, 5, 2, 5, 6, 4, 5, 4, 5, 10, 5, 7, 8, 5, 4, 6, 5, 4, 6, 6, 6, 7, 1, 5, 6, 5, 4, 4, 6, 7, 10, 7, 3, 8, 3, 3, 5, 5, 3, 6, 6, 10, 4, 5, 8, 3, 12, 4, 2, 9, 6, 6, 10, 12, 3, 3, 3, 5, 5, 6, 6, 13, 7, 4, 12, 4, 5, 8, 4, 11, 6, 12, 5, 6, 7, 14, 6, 8, 4, 2, 3, 3, 6, 10, 5, 10, 5, 9, 4, 8, 7, 8, 6, 8, 6, 7, 6, 6, 6, 12, 5, 4, 7, 8, 8, 6, 8, 4, 5, 8, 12, 7, 8, 12, 12, 13, 12, 6, 8, 11, 8, 4, 6, 7, 8, 10, 6, 7, 8, 8, 14, 10, 9, 10, 9, 8, 7, 6, 16, 8, 6, 8, 9, 7, 4, 10, 12, 8, 7, 12, 9, 7, 5, 4, 7, 7, 4, 13, 7, 9, 4, 3, 6, 7, 6, 5, 4, 5, 11, 7, 9, 9, 9, 9, 6, 8, 8, 5, 12, 5, 8, 8, 12, 10, 12, 2, 8, 5, 2, 7, 7, 2, 6, 7, 8, 5, 6, 9, 9, 5, 5, 5, 9, 9, 6, 4, 7, 8, 9, 9, 6, 6, 10, 9, 10, 8, 8, 13, 5, 6, 4, 6, 12, 4, 12, 7, 8, 16, 9, 8, 4, 5, 5, 10, 6, 7, 8, 8, 9, 5, 9, 6, 7, 10, 8, 9, 4, 10, 5, 3, 7, 10, 6, 10, 10, 8, 13, 9, 5, 8, 8, 11, 7, 8, 15, 9, 5, 5, 4, 3, 7, 4, 10, 9, 8, 7, 13, 14, 3, 8, 3, 5, 8, 9, 7, 12, 7, 3, 6, 11, 14, 11, 5, 7, 10, 6, 5, 7, 10, 3, 11, 10, 7, 6, 5, 5, 8, 7, 11, 12, 6, 11, 6, 9, 5, 4, 5, 11, 4, 4, 4, 7, 14, 7, 9, 10, 5, 11, 7, 3, 8, 6, 3, 9, 5, 9, 6, 4, 9, 3, 9, 5, 6, 3, 11, 2, 9, 4, 13, 4, 4, 9, 10, 5, 5, 5, 4, 5, 7, 7, 9, 4, 11, 10, 7, 11, 9, 9, 6, 6, 12, 3, 12, 7, 6, 6, 1, 12, 6, 10, 12, 10, 7, 10, 6, 8, 11, 9, 4, 9, 9, 6, 7, 8, 10, 4, 8, 5, 13, 4, 3, 9, 7, 11, 8, 10, 9, 12, 7, 10, 7, 7, 9, 3, 8, 12, 7, 7, 4, 10, 4, 10, 8, 5, 6, 7, 6, 10, 5, 4, 6, 7, 8, 8, 11, 5, 5, 5, 3, 5, 4, 3, 2, 6, 5, 7, 6, 8, 5, 9, 4, 5, 9, 9, 8, 8, 5, 6, 2, 9, 10, 10, 4, 5, 9, 8, 4, 9, 4, 6, 3, 11, 5, 5, 5, 10, 2, 3, 5, 9, 6, 6, 5, 7, 3, 8, 5, 7, 5, 5, 5, 3, 5, 4, 3, 7, 4, 4, 5, 5, 5, 4])
# PHASE 4 data

# # starting energy of the first channel/bin, in eV
# ev_channel_start_p4 = -0.129246831
# # width of each channel/bin, in eV
# ev_per_channel_p4 = 19.98322487
# # total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
# num_of_channels = 2048 #
# # counts for each bin as, arrays (usually y-axis value on spectra)
# counts_p4 = np.array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,124,927,3662,7119,7038,3720,977,154,14,5,2,0,0,133,128,137,163,139,156,165,143,169,136,144,113,182,161,129,136,139,143,133,147,133,132,137,110,141,124,134,126,136,95,109,125,108,117,126,95,110,112,87,83,75,108,121,129,143,120,151,101,101,93,81,86,78,81,87,115,80,97,95,97,91,98,114,85,92,97,105,81,95,102,97,86,96,96,98,84,73,103,112,120,149,173,185,208,247,243,288,260,226,198,191,140,173,136,143,121,115,103,99,116,98,100,113,100,84,84,78,76,68,79,83,87,101,84,90,103,132,158,195,195,151,149,122,84,61,84,64,87,87,97,101,104,160,237,276,353,313,305,217,185,106,106,102,144,174,226,237,243,204,220,201,215,293,352,449,423,401,351,286,224,167,145,130,105,96,76,93,73,90,85,112,86,116,115,113,109,139,114,118,111,138,105,118,117,109,91,87,97,100,82,78,89,81,98,85,77,97,105,131,194,273,337,499,576,588,542,448,379,247,145,114,82,111,106,113,155,149,213,213,214,231,199,163,161,143,150,129,160,168,178,245,302,410,653,1199,2456,5451,10753,19098,30786,42762,52671,57000,52862,43481,31092,19694,10886,5315,2544,1109,598,387,278,294,237,256,318,352,428,609,968,1549,2617,4050,5788,7575,9419,9926,9990,8639,6733,4775,3068,1842,1012,556,384,368,403,494,669,1165,2474,5115,10559,20716,36716,58338,83245,105552,118408,117713,104530,82519,57987,36272,20372,10448,4885,2191,1112,614,422,351,317,280,304,274,280,322,340,382,477,567,793,1071,1867,2893,4768,7318,10672,14162,17007,18567,18078,15844,12397,8893,5866,3365,1809,914,447,250,144,182,274,518,973,1809,2937,4347,5613,6614,7197,6978,6186,4787,3474,2294,1299,744,374,202,99,59,42,32,28,29,35,23,31,37,32,38,48,77,109,165,215,232,273,310,296,280,250,290,340,496,674,817,1042,1185,1178,1176,989,765,564,373,245,152,80,44,45,29,17,22,18,37,30,34,33,37,57,45,65,57,43,51,46,51,52,57,57,54,61,45,49,40,46,28,24,27,27,21,23,21,21,17,17,14,30,26,27,29,21,25,23,17,24,14,12,17,23,27,33,27,16,30,31,26,46,55,57,52,68,57,49,51,60,77,93,129,174,215,276,352,447,456,486,494,444,369,284,199,163,102,65,60,45,39,30,28,35,25,20,26,33,28,24,29,27,31,29,40,45,46,42,44,50,65,46,45,39,38,57,69,79,80,81,118,114,122,131,115,92,82,81,58,50,45,36,45,35,32,43,39,39,52,45,48,65,52,41,64,67,71,83,108,91,92,79,91,99,87,91,84,110,90,94,90,79,110,142,203,232,304,377,492,602,610,695,646,596,550,475,391,302,239,219,147,140,114,77,70,70,70,69,74,58,70,104,94,104,109,111,147,136,152,150,146,156,144,152,132,120,106,102,104,112,94,103,95,137,180,203,252,292,347,409,436,450,430,378,358,311,214,196,135,148,116,102,92,75,81,79,77,77,70,79,73,79,68,74,78,88,96,102,127,139,186,189,176,193,184,193,188,168,137,137,105,84,99,82,93,94,108,105,121,136,134,177,162,163,148,138,164,103,137,123,122,100,104,103,88,99,89,101,110,112,89,103,126,99,103,109,96,88,83,104,91,92,119,100,105,113,104,100,87,105,95,101,104,99,101,105,100,93,106,100,94,96,96,83,98,115,106,122,111,106,94,111,94,94,100,105,103,104,108,107,113,120,121,107,93,104,125,105,138,132,104,106,114,132,123,101,120,118,114,119,136,159,119,154,142,133,120,136,135,134,135,127,131,115,135,143,124,135,107,130,121,125,120,118,134,114,130,134,143,121,142,151,134,144,134,136,134,148,153,147,164,165,167,146,158,164,151,173,164,169,166,178,159,188,163,182,164,184,164,163,158,175,173,189,164,176,203,171,204,193,206,206,208,213,222,262,292,447,656,908,1273,1880,2689,3707,4872,6569,8310,9980,11977,13809,15150,16242,16888,16920,16481,15578,14121,12146,10177,8018,6160,4576,3269,2267,1554,1022,689,461,342,277,201,244,212,191,203,222,200,198,192,198,185,185,166,182,171,156,164,202,166,199,173,177,173,182,215,199,220,219,184,200,203,208,202,202,208,233,222,239,231,226,225,230,256,245,254,210,239,282,265,248,268,273,308,270,297,284,296,313,322,308,332,343,321,344,315,319,319,358,297,314,305,330,309,310,339,312,360,347,399,496,588,713,849,1144,1416,1803,2239,2634,2887,3049,3234,3149,3002,2857,2528,2137,1768,1482,1236,997,799,733,752,662,706,743,843,923,1006,1004,1082,1041,1108,1146,1102,1127,1123,1154,1157,1100,1096,1060,1039,941,808,709,658,516,441,321,301,261,202,184,150,150,163,154,131,127,145,135,153,147,147,153,151,145,167,144,155,169,142,153,150,168,156,131,158,162,169,159,145,153,165,162,162,148,149,191,161,166,184,142,162,165,169,150,153,171,174,198,145,164,160,180,166,171,163,164,180,167,139,160,153,164,154,175,149,182,138,123,164,166,155,140,179,171,153,152,154,160,151,156,153,168,154,155,145,144,155,167,181,165,162,156,152,190,157,168,169,187,172,164,173,178,191,188,219,215,215,287,276,321,363,364,370,377,320,360,372,300,310,300,262,257,212,208,196,181,188,181,188,148,190,160,174,159,167,160,141,163,164,152,149,159,133,164,149,149,153,140,148,148,155,142,123,161,145,139,144,141,152,154,147,162,196,224,201,218,221,203,249,247,273,269,270,279,259,252,291,281,277,273,261,277,220,265,252,264,265,264,251,256,248,239,213,184,161,180,170,176,170,123,138,139,150,166,147,147,127,131,110,123,147,149,145,147,128,147,133,124,146,134,128,135,141,140,126,153,151,157,141,146,160,157,161,129,150,153,160,157,159,166,152,134,152,153,152,123,142,154,128,112,120,125,125,135,145,128,142,127,126,115,134,118,121,114,126,110,125,114,141,129,123,129,117,138,143,148,123,141,134,127,126,130,136,119,118,100,111,126,111,103,110,117,122,108,143,111,140,116,118,103,102,113,119,119,133,120,120,106,125,132,122,118,128,120,113,117,114,121,116,113,120,111,117,96,102,117,108,121,119,115,136,109,125,139,152,137,125,146,144,132,158,150,164,136,126,120,147,135,125,123,106,151,113,120,106,113,100,159,90,102,108,124,120,112,106,104,119,116,103,107,92,114,105,86,84,113,99,99,93,94,90,90,95,82,87,79,92,92,92,91,90,92,82,80,90,89,90,97,83,82,105,89,96,84,77,79,97,107,82,78,104,84,95,86,87,89,86,109,71,98,88,99,68,87,77,79,87,100,79,112,92,76,90,81,89,80,82,88,101,90,88,96,88,84,94,94,75,86,84,67,81,75,76,92,88,89,71,64,92,82,100,87,76,80,88,91,87,82,83,65,72,82,83,82,79,105,92,78,89,78,72,79,90,67,85,66,69,81,64,74,84,77,79,86,59,66,67,85,83,65,77,79,86,79,69,76,71,94,78,60,92,68,59,74,69,76,64,85,63,75,69,99,72,59,62,72,76,69,60,84,66,65,80,73,73,63,71,64,81,70,78,73,73,54,71,62,68,55,73,73,86,57,63,65,68,66,55,77,66,72,70,69,75,63,75,68,52,68,64,55,61,60,60,67,57,70,82,62,50,55,61,76,57,50,72,67,65,49,57,57,62,73,53,63,60,68,50,57,59,68,50,63,56,50,60,59,60,59,63,50,61,47,61,54,65,51,51,55,64,49,46,58,57,58,51,53,46,54,53,54,61,63,60,41,58,61,53,57,49,49,51,45,43,51,45,50,67,58,54,44,41,43,59,47,40,44,52,49,53,40,57,45,41,42,55,46,47,38,46,44,43,47,41,39,51,51,42,45,24,45,48,41,60,43,46,44,32,40,44,45,42,51,32,40,38,33,39,38,35,56,37,40,34,41,30,31,34,37,50,35,43,33,47,38,32,44,42,40,29,44,31,40,45,55,51,41,55,36,33,35,28,45,40,29,23,45,24,20,29,31,30,23,32,27,32,25,42,35,34,30,30,29,34,28,25,25,26,24,23,33,31,31,28,21,19,30,26,27,21,26,18,38,19,21,23,25,26,21,22,20,18,19,20,26,21,22,24,25,11,22,28,14,20,20,16,16,23,22,19,25,17,23,20,22,8,17,17,24,22,26,16,24,21,13,12,22,18,16,18,12,20,16,14,14,20,20,15,19,15,20,18,27,18,20,21,26,11,14,15,9,14,16,11,18,15,19,15,8,14,11,18,12,10,14,15,20,13,12,13,11,12,12,9,16,9,8,9,17,14,7,9,9,10,10,16,11,6,7,5,9,18,8,8,11,2,6,6,7,4,6,11,5,3,6,3,11,8,2,3,5,6,5,7,0,2,3,4,1,3,5,2,0,11,8,2,2,1,6,4,4,3,2,3,6,3,2,2,4,1,2,2,3,3,4,2,1,0,4,2,2,4,2,0,1,5,0,1,2,3,3,2,2,2,2,2,1,2,3,4,1,0,2,0,0,0,2,1,1,2,2,1,3,3,2,0,1,4,1,0,2,0,2,2,1,4,0,0,1,2,0,1,0,3,0,1,0,1,1,0,0,1,1,0,0,0,0,1,1,0,1,2,1,1,2,0,1,0,0,1,1,3,1,1])

# # PHASE 5 data

# # starting energy of the first channel/bin, in eV
# ev_channel_start_p5 = 0.27312687
# # width of each channel/bin, in eV
# ev_per_channel_p5 = 19.98322487
# # total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
# num_of_channels = 2048 #
# # counts for each bin as, arrays (usually y-axis value on spectra)
# counts_p5 = np.array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,125,1012,3747,7072,7081,3629,950,146,9,2,0,0,1,137,121,120,133,132,145,124,149,129,141,153,141,144,160,154,149,127,139,141,141,154,138,121,135,128,131,159,114,133,105,117,139,128,106,112,125,101,102,112,111,99,84,103,94,126,135,131,117,111,86,49,70,87,81,70,91,88,92,83,81,88,95,89,92,84,89,97,83,88,101,95,96,100,66,80,83,95,94,93,92,118,117,133,136,177,200,225,181,182,168,155,144,150,121,125,126,104,101,110,91,103,101,94,124,81,92,83,73,91,96,89,89,82,83,85,107,129,128,165,169,179,140,124,89,86,69,68,64,82,86,94,130,172,199,273,335,350,285,213,147,124,114,120,147,183,215,216,226,195,193,198,245,304,337,423,405,356,286,246,164,123,130,89,70,71,86,79,69,81,75,76,84,69,89,101,79,78,89,80,125,113,119,91,85,101,75,77,79,69,66,70,84,79,80,96,85,95,101,151,150,236,319,455,465,571,531,441,329,229,160,120,88,106,115,118,127,179,187,209,230,189,193,168,125,138,132,129,151,182,206,229,307,398,649,1197,2562,5001,10338,18451,29394,41101,50728,54204,50702,41921,29842,18830,10691,5289,2422,1083,515,385,295,262,256,289,271,353,424,625,932,1467,2536,3886,5468,7312,9010,9776,9535,8389,6615,4614,3085,1668,973,574,421,364,381,497,713,1154,2264,4924,10457,20004,34879,56228,79521,100311,113236,113250,100817,79287,55447,35105,19962,10113,4838,2137,1015,530,398,299,270,228,249,279,299,273,324,384,464,533,739,1105,1673,2804,4561,7075,10127,13429,16216,17395,17257,15018,12029,8581,5791,3326,1712,939,456,207,148,174,282,561,1000,1713,2739,3987,5320,6428,7079,6751,5941,4805,3255,2190,1333,688,375,186,90,58,41,32,25,28,22,32,27,29,43,26,48,81,120,163,194,250,247,307,281,236,249,288,307,437,585,824,1024,1121,1141,1047,918,758,560,398,238,142,81,64,33,27,29,24,18,30,21,36,38,29,21,28,23,31,42,35,26,28,30,46,40,59,60,52,53,36,26,26,25,18,16,18,23,18,14,16,31,27,27,20,22,20,21,23,26,26,7,18,16,23,16,26,28,22,28,25,28,35,42,55,57,50,54,57,57,39,48,39,49,63,53,80,99,100,117,142,138,129,118,107,93,70,61,41,37,22,23,25,31,32,29,32,23,26,28,19,31,18,31,26,33,34,47,37,56,45,47,51,43,44,45,32,45,49,59,77,93,92,103,108,107,86,99,75,54,57,44,37,34,52,36,33,47,32,41,37,41,33,43,54,56,61,60,74,93,73,98,79,91,97,78,79,67,77,55,63,67,79,69,93,96,137,155,209,289,308,369,419,436,449,393,346,279,235,172,142,123,93,74,56,67,64,45,66,66,56,61,57,70,68,88,99,115,128,136,107,130,138,126,149,109,134,115,114,77,92,100,82,80,88,118,152,184,238,325,325,360,400,388,402,354,313,279,217,159,135,130,108,103,77,69,66,67,75,73,52,61,71,82,66,93,73,98,105,107,122,128,170,172,166,193,194,160,171,144,146,109,95,105,91,74,83,87,98,100,79,110,126,118,125,139,121,135,129,127,124,112,78,110,94,96,99,107,84,96,84,82,95,84,83,89,102,80,98,78,78,89,94,96,76,100,92,98,102,93,105,103,110,100,104,101,101,92,101,104,98,103,115,103,87,108,85,86,105,94,107,99,91,108,106,112,106,100,107,105,86,106,87,104,109,95,121,118,92,105,105,106,117,101,107,107,116,119,105,115,110,117,137,134,136,130,118,129,136,119,139,130,128,129,120,134,111,132,111,126,123,132,132,149,144,129,123,143,142,141,126,144,129,141,129,134,134,146,155,142,149,141,156,153,157,145,169,155,156,157,167,166,177,174,172,173,166,198,168,171,170,149,162,154,182,163,162,171,177,182,180,169,217,191,177,170,242,249,309,448,627,808,1168,1786,2501,3483,4776,6183,7796,9550,11464,13060,14517,15939,16342,16490,15931,15021,13400,11572,9653,7727,6006,4455,3174,2095,1447,965,611,457,349,247,227,192,169,208,176,156,197,182,201,178,184,173,184,162,179,192,182,181,174,162,175,178,189,190,205,197,195,185,178,167,204,189,209,202,221,235,210,236,217,220,254,273,231,226,240,240,267,243,257,269,288,316,282,291,268,299,288,285,298,289,301,337,306,319,291,319,319,327,303,308,309,307,292,296,299,342,323,397,396,499,612,720,826,1145,1423,1808,2163,2471,2715,3105,3155,3089,2852,2729,2470,2173,1755,1403,1162,936,836,713,674,701,708,764,834,893,996,1005,1047,1003,1068,1083,1050,1082,1099,1058,1144,1112,1120,1057,1004,893,849,753,607,555,420,316,302,231,205,184,170,183,161,143,127,160,161,122,142,154,135,161,141,157,146,150,153,152,159,165,131,148,187,144,152,148,149,128,147,165,150,143,175,174,146,173,160,155,155,178,181,167,153,171,163,156,169,158,165,164,182,179,146,158,147,166,152,133,185,157,164,158,164,143,143,149,166,140,174,169,149,173,151,132,159,161,134,155,174,178,155,164,175,144,166,147,151,172,157,159,149,147,159,158,169,165,161,155,168,147,161,183,195,170,226,226,277,271,324,355,321,338,350,335,396,285,327,279,285,277,280,228,196,193,188,192,161,173,152,161,167,154,160,158,176,178,151,164,175,154,153,171,165,125,148,152,137,133,141,132,136,131,141,141,129,126,147,141,163,130,128,170,152,183,183,211,207,209,223,233,294,285,262,275,251,286,266,260,243,257,257,276,276,280,282,271,289,272,245,258,249,204,212,193,189,165,169,167,157,144,148,140,137,165,135,145,138,136,133,133,129,128,116,125,136,134,151,130,123,126,129,147,165,130,149,121,148,143,150,155,139,149,141,142,152,155,175,147,139,140,163,128,147,154,155,148,116,139,149,128,122,130,117,123,135,119,125,127,111,113,139,114,114,134,104,103,126,122,118,113,118,130,127,131,144,114,128,118,117,139,136,123,131,113,108,135,126,112,119,122,116,126,119,117,126,109,116,117,110,117,128,111,119,123,119,109,110,118,113,113,115,101,104,106,126,115,110,115,112,109,118,120,129,118,111,112,92,114,117,91,105,120,134,112,149,148,116,125,118,133,131,147,130,113,115,123,106,104,93,97,115,111,100,111,108,118,122,100,104,105,98,101,92,104,107,132,98,100,122,105,104,98,110,93,86,98,83,98,101,94,91,108,91,99,106,107,90,97,88,96,87,84,85,120,107,89,120,82,105,101,75,90,86,84,102,98,84,107,65,92,90,94,96,87,101,90,75,74,98,93,83,75,102,87,87,92,82,66,82,80,96,89,90,70,99,88,86,89,87,67,83,73,84,76,84,86,82,91,70,83,92,86,85,76,92,75,79,86,87,71,56,83,94,72,78,71,71,85,74,78,76,74,85,78,77,77,73,73,81,83,82,65,82,84,68,81,92,76,69,79,76,92,84,81,65,75,69,77,72,78,102,82,73,92,72,91,64,70,81,77,97,93,60,72,66,73,69,71,73,57,68,77,71,65,75,76,75,90,70,62,70,64,67,83,61,58,61,72,82,74,68,67,61,66,76,84,74,81,86,76,70,75,59,67,61,82,67,69,56,51,60,75,49,69,58,64,54,58,85,67,61,63,60,58,48,65,64,48,50,67,64,51,73,65,55,73,61,53,55,53,63,64,58,66,48,44,56,64,55,60,56,72,62,63,52,47,51,48,59,48,57,58,45,60,66,51,54,48,56,66,58,55,55,65,41,57,45,57,60,52,49,43,54,50,49,47,59,55,46,46,39,61,55,53,54,54,46,54,48,40,39,49,59,53,54,51,45,53,40,44,47,39,50,35,50,47,43,46,54,44,52,45,37,37,37,51,40,45,53,57,43,38,43,39,42,37,44,39,32,43,42,37,39,44,38,45,34,33,27,38,42,45,33,43,31,29,31,34,43,48,48,44,47,38,30,41,37,46,38,45,50,40,37,40,41,46,44,37,33,35,30,33,27,31,30,29,34,30,33,26,35,28,33,21,24,32,28,18,22,20,29,23,36,23,23,19,24,32,20,13,26,27,24,20,19,28,24,30,24,30,19,27,24,25,15,20,25,19,23,18,30,28,29,19,20,16,15,22,22,20,16,22,19,19,19,27,12,21,17,25,21,26,22,14,20,25,20,16,11,12,13,13,11,11,12,20,10,15,16,22,18,14,10,20,19,22,22,16,16,18,23,22,13,12,18,17,14,17,15,18,17,14,18,14,12,19,6,13,15,14,13,6,14,13,11,9,4,12,10,15,11,21,6,5,16,7,13,14,7,6,14,13,12,11,15,7,8,10,4,4,7,9,8,5,7,8,10,7,5,7,3,3,6,3,4,1,3,4,6,10,0,7,5,5,6,7,1,4,5,5,2,3,8,3,4,4,5,6,4,4,2,7,3,4,6,2,4,7,2,3,5,1,1,1,3,3,2,3,2,1,0,1,4,2,1,1,3,2,1,0,2,1,1,0,0,1,1,0,1,0,1,0,0,3,1,1,2,2,2,0,2,2,1,0,1,1,1,0,0,1,0,1,2,0,0,1,1,2,0,1,0,5,1,0,0,1,1,1,4,0,0,3,1,0,1,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0,1])

# # PHASE 6 data

# # starting energy of the first channel/bin, in eV
# ev_channel_start_p6 = -0.02291452
# # width of each channel/bin, in eV
# ev_per_channel_p6 = 19.98322487
# # total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
# num_of_channels = 2048 #
# # counts for each bin as, arrays (usually y-axis value on spectra)
# counts_p6 = np.array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,120,958,3721,7053,7082,3702,980,144,14,0,0,2,0,160,149,148,127,149,155,117,148,157,163,157,141,129,165,130,149,132,164,147,133,146,139,140,135,126,153,139,126,124,125,116,108,118,118,106,99,117,110,112,120,87,104,120,163,139,144,126,118,109,100,76,81,92,71,82,86,82,103,93,97,104,94,74,99,73,100,97,83,91,90,98,128,95,94,93,108,97,79,90,96,101,107,110,137,188,232,203,193,177,155,149,178,158,137,137,112,110,99,101,108,110,73,107,83,91,76,84,76,87,78,76,86,88,74,91,106,130,162,177,171,144,124,106,98,68,84,58,81,98,99,91,112,166,234,280,353,342,300,220,183,123,107,108,144,162,215,272,217,200,188,197,218,286,362,428,431,381,309,274,136,102,75,104,90,88,76,74,79,77,69,66,69,69,87,74,71,69,89,96,96,136,99,126,98,98,106,80,65,64,86,71,76,75,91,76,87,101,116,132,180,250,347,476,510,527,467,437,331,248,149,134,101,77,97,92,133,184,198,202,231,239,220,173,169,142,140,174,159,172,199,238,281,395,613,1254,2470,5361,10658,18960,30491,42663,52352,56364,52924,43699,31055,19451,11035,5528,2378,1142,515,368,290,295,271,229,297,312,432,641,944,1579,2593,4082,5796,7813,9137,9956,9916,8864,6855,4916,3042,1794,1056,606,395,372,391,472,669,1200,2292,5185,10531,20673,36159,58111,82245,103946,117133,117054,104788,82174,57955,36275,20358,10393,4871,2240,1017,610,408,362,310,284,269,279,273,313,352,358,469,583,758,1124,1818,2842,4583,7315,10414,13837,16804,18103,18063,15777,12450,8927,5884,3407,1769,896,414,221,159,183,278,521,1009,1728,2818,4063,5591,6515,7059,6840,6105,4751,3453,2301,1338,749,376,187,101,65,33,43,30,26,24,27,36,27,38,44,47,85,109,148,179,225,245,284,287,272,227,246,345,459,599,830,989,1128,1183,1142,936,726,611,402,276,130,86,52,39,32,28,21,15,21,24,22,21,28,22,26,21,26,26,25,25,33,42,50,47,40,53,54,49,41,37,30,22,33,22,16,27,19,21,26,30,19,28,36,16,24,17,22,19,15,19,15,23,22,21,23,14,20,17,22,22,44,38,49,52,57,56,59,44,51,31,37,24,32,38,28,50,40,54,45,53,46,58,56,41,39,32,13,24,25,28,35,18,21,27,24,28,20,25,29,32,29,36,32,31,45,58,34,51,50,41,35,37,32,34,45,45,46,61,69,80,99,115,104,103,86,102,68,57,48,47,43,46,29,33,29,26,37,35,42,39,34,46,45,52,63,64,62,71,96,87,90,72,57,90,88,77,57,69,42,59,70,91,75,86,110,141,223,241,298,344,394,376,439,382,312,261,212,179,117,93,96,63,51,69,56,43,45,72,56,55,65,74,83,96,90,101,131,125,120,143,113,141,125,99,119,113,113,109,91,78,81,84,90,111,164,242,234,292,365,413,420,442,436,400,369,315,230,172,154,128,110,89,90,84,75,77,65,73,54,67,66,59,57,58,75,80,106,111,122,138,154,171,184,191,180,187,167,163,134,121,107,98,77,101,75,79,79,107,78,97,111,118,125,127,132,117,105,101,102,114,89,106,101,95,96,82,97,95,71,89,101,100,94,84,87,91,85,84,79,91,103,95,73,91,88,86,91,86,101,79,96,109,80,85,83,113,102,108,103,96,83,111,96,95,100,88,104,97,92,104,101,92,89,116,114,107,103,87,103,124,106,111,118,134,101,110,97,120,94,108,99,120,104,110,105,112,103,124,106,121,119,100,118,125,125,137,128,133,151,121,126,124,114,135,136,129,131,114,120,124,111,115,129,127,142,117,138,141,143,121,145,147,151,159,135,151,142,146,153,133,140,148,156,166,162,164,141,152,173,161,174,179,153,165,148,191,179,184,173,145,161,169,184,174,204,161,196,194,182,202,202,190,205,199,233,263,347,475,575,896,1209,1808,2597,3522,4927,6472,8009,9876,11567,13637,14856,16099,16954,17051,16434,15239,13883,12046,9799,8077,6143,4587,3265,2236,1530,1007,698,482,312,258,209,229,194,205,161,180,179,192,181,188,144,192,184,174,165,180,170,165,164,176,191,167,193,196,204,192,197,204,185,202,192,174,207,209,212,206,236,203,241,226,215,238,180,241,242,238,233,263,268,271,256,255,300,302,310,329,331,318,286,330,294,296,332,337,320,346,322,323,322,316,323,321,292,293,289,312,331,388,392,463,546,695,907,1071,1478,1775,2231,2533,2763,3040,3212,3126,3030,2850,2451,2201,1794,1488,1218,949,843,783,679,754,674,760,832,901,1001,943,1058,1116,1089,1105,1129,1137,1140,1132,1212,1139,1112,1046,1036,931,812,698,580,496,457,336,286,231,195,203,140,152,183,162,150,152,111,123,141,145,133,160,147,141,145,142,153,147,132,152,162,140,147,191,143,159,152,141,153,139,152,162,135,166,134,141,181,153,176,161,160,161,150,180,169,158,148,161,153,162,143,158,154,181,165,154,173,182,171,148,140,152,165,163,139,183,157,147,164,145,167,159,153,155,159,143,147,180,147,162,147,162,155,184,176,163,156,162,155,127,174,177,175,170,161,177,195,173,174,166,182,186,172,219,214,232,256,270,301,277,348,342,349,363,345,356,323,326,307,272,275,227,227,212,171,160,165,194,168,167,167,166,161,172,158,157,173,157,168,156,172,168,149,127,163,157,162,130,145,127,151,152,145,140,110,124,120,149,154,153,166,166,171,212,191,220,225,219,231,290,286,254,299,293,303,263,250,261,252,220,252,260,258,223,298,284,277,276,241,247,230,242,219,191,179,183,158,149,127,166,140,144,126,136,143,127,167,128,135,156,131,134,121,129,124,114,129,132,113,134,147,132,110,138,146,141,129,155,158,157,156,137,162,149,134,150,153,128,155,127,156,141,171,140,146,140,111,135,128,135,139,137,127,124,114,123,127,118,135,129,116,127,132,122,113,113,114,134,117,127,119,140,130,126,153,110,132,146,148,147,139,121,113,123,132,139,115,120,119,146,123,100,106,130,99,116,135,142,120,131,125,124,116,102,108,135,102,124,111,115,119,122,96,116,137,113,102,128,103,99,114,129,105,116,100,111,124,95,125,120,104,127,136,141,108,116,139,147,145,149,135,134,118,130,122,126,118,108,115,108,108,125,95,101,109,124,106,110,127,121,111,108,85,102,96,103,108,120,112,108,113,102,108,108,101,77,96,105,83,105,108,104,99,87,73,87,86,107,93,104,96,87,94,74,87,87,102,78,103,79,100,111,107,107,114,73,92,77,85,83,93,85,82,69,91,88,86,89,84,92,91,73,82,101,78,84,77,92,83,89,87,83,79,82,91,85,103,103,77,93,90,83,100,74,97,79,93,81,96,76,73,65,80,99,66,85,83,98,80,86,80,91,87,94,87,85,69,90,89,88,73,94,65,77,76,72,97,81,82,85,91,84,95,72,81,83,76,83,67,68,72,97,66,85,66,63,75,81,77,89,69,79,71,68,79,70,76,69,91,90,85,77,81,69,70,61,70,74,83,60,78,63,76,82,66,80,67,82,73,83,80,65,74,73,72,60,76,62,66,74,58,73,72,70,70,72,54,67,66,64,69,75,69,63,79,71,60,78,49,60,59,48,62,74,71,70,67,51,66,73,59,50,75,75,69,59,79,71,81,82,52,70,48,68,54,73,51,82,67,58,65,71,49,54,51,71,53,59,42,64,61,63,53,64,55,62,62,49,52,56,54,65,56,59,52,61,52,53,53,52,54,46,56,43,47,51,62,50,51,46,69,81,54,50,63,49,34,52,66,37,51,49,51,48,51,53,48,42,49,47,35,44,43,49,47,40,49,44,45,49,54,48,48,46,54,54,54,35,60,46,55,47,52,45,50,31,38,39,49,45,37,42,46,37,50,43,39,56,46,44,41,54,33,47,38,40,35,30,35,32,45,39,35,30,46,32,32,35,34,40,39,40,49,31,32,36,35,52,62,46,47,40,56,45,40,31,41,46,37,37,39,44,35,38,27,39,39,26,35,30,34,28,27,27,25,30,29,33,26,29,25,29,22,37,30,19,22,26,26,25,24,34,21,25,19,18,15,17,31,19,27,22,28,26,33,25,27,15,28,13,26,17,24,28,23,19,24,27,21,24,17,23,24,25,13,28,13,25,33,20,14,23,18,12,18,19,19,20,19,23,27,20,16,20,15,11,20,16,21,24,13,22,20,16,14,17,16,11,16,25,21,27,8,20,12,13,21,11,18,12,12,12,14,13,14,17,15,15,16,9,22,16,23,10,11,16,9,18,8,14,7,17,9,13,12,9,11,12,10,7,9,3,9,6,6,12,9,4,12,8,9,7,5,8,8,4,7,10,5,8,7,5,4,9,7,6,6,8,6,7,2,4,5,9,3,1,4,2,6,6,5,6,4,2,4,5,5,4,4,1,3,2,5,3,3,1,3,5,4,3,1,0,1,4,3,3,0,1,6,2,0,1,2,0,1,3,2,4,4,0,3,2,2,1,2,0,2,1,3,0,0,2,2,0,2,2,0,1,1,0,2,0,0,2,0,1,0,1,1,0,0,0,0,1,3,2,1,1,1,0,2,0,2,0,0,3,0,1,1,1,1,0,1,1,1,2,1,1,1,0,0,4,2,1,0,1,0,1,0,2,0,0,1])

# # PHASE 7 data

# # starting energy of the first channel/bin, in eV
# ev_channel_start_p7 = -0.105242968
# # width of each channel/bin, in eV
# ev_per_channel_p7 = 19.98322487
# # total number of channels/bins in the spectra (nearly always 2048 for bruker pXRF instruments typically, should = len(counts))
# num_of_channels = 2048 #
# # counts for each bin as, arrays (usually y-axis value on spectra)
# counts_p7 = np.array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,116,968,3651,7103,7195,3690,968,140,19,4,0,0,0,149,112,123,124,148,130,149,155,125,136,147,118,162,128,161,143,138,151,135,150,149,142,141,121,136,126,140,137,141,122,116,123,120,120,87,114,84,102,106,95,102,110,96,127,128,160,110,143,113,109,76,77,98,73,91,72,84,87,85,94,89,92,95,86,83,104,82,84,109,104,95,80,96,89,97,92,83,101,92,96,79,108,104,154,145,196,215,179,179,171,163,136,161,131,118,115,113,91,98,77,112,97,103,118,70,85,76,83,76,78,66,84,87,86,96,107,127,158,185,200,163,140,110,106,83,77,76,90,73,79,101,133,156,231,305,356,350,289,207,167,111,102,106,149,160,191,219,225,218,187,216,249,310,350,445,449,378,330,224,156,112,93,86,69,63,67,67,77,60,70,71,74,65,76,64,79,81,109,110,120,123,99,102,114,73,81,84,85,71,66,79,70,89,86,77,85,109,125,153,187,243,314,439,535,585,516,470,355,216,153,133,115,112,101,103,145,151,211,216,231,222,195,162,175,152,154,167,141,169,229,247,300,435,635,1167,2468,5236,10653,18930,29966,42494,52100,55684,52458,43159,30866,19448,10667,5344,2406,1127,572,357,289,299,257,272,279,342,421,595,953,1520,2548,3994,5710,7594,9142,10057,9835,8587,6742,4752,3130,1804,1061,585,414,368,412,468,738,1269,2334,5168,10530,20183,36360,57345,81527,103688,116918,116050,102982,81627,57284,35909,20292,10206,4868,2170,1062,566,365,367,293,270,281,280,284,298,338,401,464,554,758,1116,1734,2875,4487,7229,10331,13940,16687,17966,17638,15581,12343,8790,5645,3322,1772,924,439,229,160,210,277,566,984,1812,2899,4124,5450,6508,7180,7050,6147,4822,3412,2186,1286,710,373,211,87,60,34,40,33,32,34,33,25,24,39,42,61,70,106,174,187,254,273,296,312,287,280,258,327,477,649,878,986,1172,1216,1042,988,772,562,370,238,146,59,50,31,23,19,24,14,24,22,24,38,27,31,28,25,16,29,28,23,32,49,54,49,46,53,60,44,41,26,31,28,16,18,14,22,13,22,23,29,26,22,27,19,20,25,19,20,19,20,14,17,25,19,12,23,24,21,26,30,34,39,37,46,41,63,49,52,42,41,36,35,35,28,21,20,24,28,19,39,27,36,21,27,32,24,19,18,16,21,18,26,22,23,27,16,30,20,26,29,22,34,35,45,41,49,49,45,45,35,45,51,45,48,35,41,57,56,62,86,100,105,96,105,96,71,78,69,45,47,46,30,32,40,26,38,34,29,42,53,38,39,46,47,74,69,70,66,65,95,92,96,73,73,70,66,59,48,65,62,78,65,77,82,119,160,180,261,302,324,414,377,358,330,295,254,184,144,108,74,75,59,57,53,43,44,48,37,62,59,51,82,96,100,107,112,114,129,119,141,144,130,136,132,118,114,100,95,109,99,92,75,102,111,158,206,257,310,390,423,407,404,434,374,327,270,215,174,152,138,102,94,92,81,67,61,85,64,81,61,90,77,67,73,82,82,105,109,125,142,164,198,201,210,191,167,177,166,152,105,92,98,85,83,91,99,93,95,73,103,115,127,110,105,119,133,118,119,93,110,113,113,98,110,102,103,89,90,101,102,88,82,86,99,80,90,88,95,99,103,97,85,71,84,105,111,91,106,103,105,101,105,124,88,105,101,115,103,112,91,130,101,106,96,73,83,91,92,97,104,103,108,98,121,93,94,97,106,115,110,106,101,132,118,100,107,115,81,110,111,99,110,110,97,100,90,118,116,120,135,114,118,136,119,119,133,149,141,148,155,107,116,128,139,129,129,152,127,119,135,113,118,123,127,106,120,134,138,124,123,116,129,150,175,147,126,142,134,160,178,139,169,165,141,162,173,173,181,169,161,160,175,161,166,182,165,206,162,164,174,185,195,169,186,193,161,163,201,193,160,201,186,199,220,246,277,313,401,615,873,1286,1804,2595,3537,4843,6365,8061,9813,11687,13399,14877,16030,16751,16786,16211,15301,13861,11857,9997,7852,5969,4525,3101,2268,1527,1004,628,463,333,270,197,220,199,217,211,192,176,191,180,178,179,175,169,199,173,172,174,158,191,188,191,199,171,202,180,189,169,186,202,166,195,209,196,218,220,212,221,242,224,231,254,242,248,258,255,235,235,253,265,251,279,285,255,270,303,271,303,283,310,351,295,319,320,337,326,343,326,316,337,352,319,307,317,313,329,349,321,390,416,498,559,713,877,1126,1361,1808,2234,2493,2830,3004,3272,3134,2973,2785,2421,2109,1761,1398,1215,948,782,746,683,650,707,759,783,922,917,992,1013,1066,1079,1119,1054,1105,1089,1169,1118,1144,1082,1115,1014,924,737,724,603,543,455,330,290,239,197,194,171,155,174,131,144,133,147,140,140,147,127,141,142,136,148,150,150,145,146,152,157,162,140,132,138,157,155,152,157,139,138,162,167,152,134,152,153,143,163,148,145,167,184,173,154,150,167,162,164,156,179,160,147,179,189,160,152,173,166,178,131,147,175,171,154,156,180,167,156,150,142,130,155,157,165,158,155,151,162,175,156,144,150,152,165,164,153,188,167,169,182,198,148,155,158,197,159,178,170,185,178,193,170,200,196,243,250,251,280,302,329,331,356,337,357,357,303,328,274,280,238,242,205,203,210,180,156,168,173,169,158,163,178,154,163,160,147,175,181,156,173,161,145,128,129,141,153,133,160,123,137,140,131,147,132,156,126,132,127,144,153,170,184,163,180,218,207,206,229,243,298,256,256,289,266,252,256,247,269,274,232,249,276,274,279,259,251,264,248,232,229,226,215,179,169,147,164,137,155,175,146,134,143,144,139,129,157,134,133,129,130,127,128,114,127,106,133,119,126,129,139,155,124,127,125,161,143,153,165,133,138,159,163,161,165,158,146,123,138,164,150,149,139,152,166,130,133,140,128,134,144,115,110,123,118,112,118,120,130,118,114,116,114,134,108,117,128,124,116,129,107,101,130,131,115,134,114,149,132,150,119,118,126,116,128,124,125,123,133,117,122,105,121,119,121,129,123,114,112,126,125,122,120,107,134,111,125,122,113,106,114,126,111,124,119,111,113,114,108,124,91,109,104,131,118,87,110,115,99,134,123,113,133,131,100,121,156,120,125,129,132,119,122,139,149,143,126,120,130,111,120,115,114,113,119,88,114,130,104,111,111,114,108,103,106,101,106,94,91,97,122,109,121,104,98,91,110,90,106,94,78,91,88,96,98,95,100,90,95,89,94,100,91,94,86,97,82,94,94,85,97,100,88,77,75,96,84,102,83,80,69,85,83,83,84,97,89,79,87,66,81,94,88,91,82,69,72,99,81,72,69,91,96,94,97,87,90,94,84,77,76,83,87,87,78,83,90,73,65,77,74,70,81,69,68,81,76,79,66,70,78,89,94,83,86,81,80,73,78,84,71,81,98,60,74,81,75,67,75,80,64,79,71,60,70,77,79,76,62,71,84,78,89,84,86,80,77,71,93,73,65,71,75,72,83,68,73,72,61,73,68,99,70,58,70,81,68,77,65,69,74,63,62,72,69,73,92,73,61,64,66,78,73,68,69,61,69,60,72,66,75,61,60,65,69,69,68,69,66,57,63,69,62,76,58,73,62,69,69,63,61,72,68,62,64,64,60,65,60,63,60,65,62,54,62,59,69,67,57,48,71,48,63,49,61,73,59,57,64,53,51,57,63,61,36,54,66,69,59,48,67,58,50,56,44,59,52,74,54,48,58,60,69,67,58,64,57,57,64,48,57,61,68,51,61,54,54,63,53,53,44,53,56,49,43,54,48,58,61,58,58,41,61,52,58,60,37,50,53,47,49,47,38,51,39,61,49,41,47,50,46,47,49,49,46,53,54,59,38,43,44,49,46,45,38,48,46,51,32,52,53,41,57,38,40,28,35,52,42,37,43,43,49,42,35,28,39,41,32,36,44,32,37,35,48,30,32,33,30,36,29,36,39,34,49,40,50,41,38,39,34,36,44,38,43,44,40,31,36,45,41,38,35,37,33,37,28,27,33,25,38,26,33,27,33,26,23,26,24,31,35,26,21,24,31,32,21,35,24,27,22,28,21,20,21,23,32,19,27,27,27,21,17,25,22,23,14,33,25,20,15,25,28,21,19,18,14,31,22,23,17,21,23,23,17,22,18,27,30,24,18,16,20,16,35,17,20,25,18,22,16,21,12,19,15,25,15,11,13,22,18,21,14,19,24,18,21,18,25,22,18,20,19,15,18,22,15,17,12,18,18,9,12,9,12,12,17,10,7,15,19,16,12,16,12,16,13,12,17,15,9,10,12,17,7,7,6,7,12,7,9,5,13,8,8,8,12,13,9,6,14,10,6,6,13,3,5,7,8,5,5,5,10,7,0,5,12,7,3,2,7,5,6,9,4,3,4,5,6,5,4,5,2,6,1,1,2,2,5,2,4,2,3,6,5,5,3,6,1,4,5,3,1,4,2,3,1,1,1,1,2,2,4,5,0,3,2,1,0,1,2,1,0,1,2,2,1,2,1,1,1,1,0,2,1,4,1,0,2,2,0,0,1,3,0,0,1,1,0,1,1,0,0,0,0,2,1,1,0,2,0,1,0,0,3,0,2,3,1,0,0,1,1,0,0,3,0,0,0,2,0,0,0,0,1,3,1,0,0,1,1,0,0])



# Plot Spectra

# generate the energies array (i.e. at which energy is each bin?, len should be same as len(counts).) (usually x-axis value on spectra)
lines = []
try:
  energies_p1 = np.array(list((i*ev_per_channel_p1+ev_channel_start_p1) for i in range(0,num_of_channels)))
  lines.append((counts_p1, energies_p1))
except: pass
try:
  energies_p2 = np.array(list((i*ev_per_channel_p2+ev_channel_start_p2) for i in range(0,num_of_channels)))
  lines.append((counts_p2, energies_p2))
except: pass
try:
  energies_p3 = np.array(list((i*ev_per_channel_p3+ev_channel_start_p3) for i in range(0,num_of_channels)))
  lines.append((counts_p3, energies_p3))
except: pass
try:
  energies_p4 = np.array(list((i*ev_per_channel_p4+ev_channel_start_p4) for i in range(0,num_of_channels)))
  lines.append((counts_p4, energies_p4))
except: pass

try:
  energies_p5 = np.array(list((i*ev_per_channel_p5+ev_channel_start_p5) for i in range(0,num_of_channels)))
  lines.append((counts_p5, energies_p5))
except: pass

try:
  energies_p6 = np.array(list((i*ev_per_channel_p6+ev_channel_start_p6) for i in range(0,num_of_channels)))
  lines.append((counts_p6, energies_p6))
except: pass

try:
  energies_p7 = np.array(list((i*ev_per_channel_p7+ev_channel_start_p7) for i in range(0,num_of_channels)))
  lines.append((counts_p7, energies_p7))
except: pass



plt.figure(figsize=(16, 8)).set_tight_layout(True)  # Adjust the figure size as needed


for line in lines:
    y_values, x_values = line
    plt.plot(x_values, y_values)

plt.axhline(y=0, color='black', ls='-', lw=1)


plt.axvline(x=9990, color='gray', ls=':', lw=1)
plt.text(x=9990,y=0,s='Hg La',rotation=270,va='top')
plt.axvline(x=11820, color='gray', ls=':', lw=1)
plt.text(x=11820,y=0,s='Hg Lb',rotation=270,va='top')

plt.xlabel('Energy (eV)')
plt.ylabel('Counts')
plt.title('Spectra')
# plt.legend(['Duplex Only', 'Hg 56.8', 'Hg 29.9', 'Hg 12.3', 'Hg 3.21', 'Hg 0.64', 'Blank'])  # Customize the legend labels as needed
#plt.grid(True, which='both', axis='both')

plt.minorticks_on()
plt.rcParams['path.simplify'] = False
plt.style.use("seaborn-v0_8-whitegrid")
plt.show()